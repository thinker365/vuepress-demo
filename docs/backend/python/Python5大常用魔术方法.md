[[toc]]

- Python 中，以双下划线__包起来的方法，统称为：魔术方法（Magic Method）
- 魔术方法是一个类或对象中的特殊方法，和普通方法的区别在于，普通方法需要手动调用，而魔术方法是在特定时刻自动触发执行的
- 如果希望根据自己的程序定制自己特殊功能的类，那么就需要对这些魔术方法进行重写

## __new__
1. 说明：实例化对象方法
2. 触发时机：在实例化时触发
3. 参数：至少得有一个cls接收当前类，写法为__new__(cls, *args, **kwargs)
4. 返回值：必须使用return关键字返回一个对象实例
5. 作用：实例化(创建)对象，开辟内存地址空间对象并返回
6. 注意：实例化对象是Object类底层实现，其他类继承了Object的__new__才能够实现实例化对象

## __init__
1. 说明：初始化方法，相当于java中的构造方法，在__new__执行后被调用
2. 触发时机：初始化对象时触发（区别于__new__实例化时的触发）
3. 参数：至少得有一个self接收__new__方法返回的对象，写法为__init__(self, name, age)
4. 返回值：无
5. 作用：初始化对象的成员
6. 注意：使用该方式初始化的成员都是直接写入对象当中，类中无法具有

## __del__
1. 说明：析构魔术方法
2. 触发时机：当一块地址空间没有任何指针引用的时候被触发
	- 在 Python 解释器中，当所有代码程序执行完成则会进行垃圾回收，也叫内存释放，这时就会触发__del__方法
	- 使用del 对象名显示删除引用关系时，如果此操作将某块地址空间的最后一个引用关系给删除，则会触发__del__方法
5. 参数：仅只一个self参数接收对象
6. 返回值：无
7. 作用：使用完对象时回收资源，没有指针引用的时候会调用，绝大多数时候不需要重写
8. 注意：del 对象名不一定会触发当前方法，只有某块地址空间无任何引用时才会触发

## __call__
1. 说明：调用对象函数的魔术方法
2. 触发时机：将对象当作函数调用时触发，使用形式为对象名称()，会默认调用__call__函数里的内容
3. 参数：至少得有一个self接收对象，剩余参数根据调用时传入的参数决定，写法为__call__(self, args)
4. 返回值：根据具体重写逻辑而定
5. 作用：将复杂的步骤统一放在该函数内实现，减少调用的步骤，比较方便
6. 注意：无

## __str__
1. 说明：当print(对象名)时想看到更多的信息时，可以重写__str__方法，将想要输出的信息放在__str__函数中返回
2. 触发时机：使用print(对象名)或者str(对象名)的时候触发
3. 参数：一个self参数接收对象
4. 返回值：必须是字符串类型
5. 作用：print(对象名)时可以自定义输出更多有用信息
6. 注意：无

## Python 代码
1. 代码实例
	```
	"""
	作者: liulinyuan
	时间: 2022/7/27/0027 22:00
	文件: tmp.py
	"""


	class People:
		"""
		python魔术方法
		"""

		def __new__(cls, *args, **kwargs):
			"""
			创建对象
			:param args:
			:param kwargs:
			"""
			print('调用父类的__new__()方法创建对象，开辟内存空间')
			instance = super().__new__(cls)
			print('将创建的地址空间对象返回，交给__init__方法接收')
			return instance

		def __init__(self, name):
			"""
			实例化对象
			"""
			print('在__new__方法返回的内存空间地址中放置name属性')
			self.name = name

		def __call__(self, *args, **kwargs):
			"""
			对象作为函数调用时的逻辑
			:param args:
			:param kwargs:
			:return:
			"""
			print(f'__call__方法，接受到的参数：{args, kwargs}')

		def __del__(self):
			"""
			删除对象
			:return:
			"""
			print('__del__析构方法，删除对象，释放内存空间')

		def __str__(self):
			"""
			自定义print(对象名)时的输出内容
			:return:
			"""
			return f'对象的name是：{self.name}'


	if __name__ == '__main__':
		p = People('thinker365')
		p('a', b=1)
		print(p)
	```
2. 结果输出
	```
	调用父类的__new__()方法创建对象，开辟内存空间
	将创建的地址空间对象返回，交给__init__方法接收
	在__new__方法返回的内存空间地址中放置name属性
	__call__方法，接受到的参数：(('a',), {'b': 1})
	对象的name是：thinker365
	__del__析构方法，删除对象，释放内存空间
	```
